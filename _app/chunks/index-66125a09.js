import{S as t,i as e,s as n,e as s,c as o,a as i,d as l,b as r,f as a,F as d,G as c,L as u,t as f,g as p,h,l as g,H as y}from"./vendor-1d56b9c4.js";const m=window;function b(t,e,n={}){const s=Object.assign({tab:"\t",indentOn:/{$/,spellcheck:!1,catchTab:!0,preserveIdent:!0,addClosing:!0,history:!0,window:m},n),o=s.window,i=o.document;let l,r,a=[],d=[],c=-1,u=!1,f=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;t.setAttribute("contentEditable",f?"true":"plaintext-only"),t.setAttribute("spellcheck",s.spellcheck?"true":"false"),t.style.outline="none",t.style.overflowWrap="break-word",t.style.overflowY="auto",t.style.resize="vertical",t.style.whiteSpace="pre-wrap",e(t);const p=S((()=>{const n=C();e(t,n),v(n)}),30);let h=!1;const g=t=>!N(t)&&!L(t)&&"Meta"!==t.key&&"Control"!==t.key&&"Alt"!==t.key&&!t.key.startsWith("Arrow"),y=S((t=>{g(t)&&(O(),h=!1)}),300),b=(e,n)=>{a.push([e,n]),t.addEventListener(e,n)};function C(){const e=D(),n={start:0,end:0,dir:void 0};return x(t,(t=>{if(t===e.anchorNode&&t===e.focusNode)return n.start+=e.anchorOffset,n.end+=e.focusOffset,n.dir=e.anchorOffset<=e.focusOffset?"->":"<-","stop";if(t===e.anchorNode){if(n.start+=e.anchorOffset,n.dir)return"stop";n.dir="->"}else if(t===e.focusNode){if(n.end+=e.focusOffset,n.dir)return"stop";n.dir="<-"}t.nodeType===Node.TEXT_NODE&&("->"!=n.dir&&(n.start+=t.nodeValue.length),"<-"!=n.dir&&(n.end+=t.nodeValue.length))})),n}function v(e){const n=D();let s,o,i=0,l=0;if(e.dir||(e.dir="->"),e.start<0&&(e.start=0),e.end<0&&(e.end=0),"<-"==e.dir){const{start:t,end:n}=e;e.start=n,e.end=t}let r=0;x(t,(t=>{if(t.nodeType!==Node.TEXT_NODE)return;const n=(t.nodeValue||"").length;if(r+n>=e.start&&(s||(s=t,i=e.start-r),r+n>=e.end))return o=t,l=e.end-r,"stop";r+=n})),s||(s=t),o||(o=t),"<-"==e.dir&&([s,i,o,l]=[o,l,s,i]),n.setBaseAndExtent(s,i,o,l)}function k(){const e=D().getRangeAt(0),n=i.createRange();return n.selectNodeContents(t),n.setEnd(e.startContainer,e.startOffset),n.toString()}function w(){const e=D().getRangeAt(0),n=i.createRange();return n.selectNodeContents(t),n.setStart(e.endContainer,e.endOffset),n.toString()}function E(t){if(f&&"Enter"===t.key)if(j(t),t.stopPropagation(),""==w()){$("\n ");const t=C();t.start=--t.end,v(t)}else $("\n")}function O(){if(!u)return;const e=t.innerHTML,n=C(),s=d[c];if(s&&s.html===e&&s.pos.start===n.start&&s.pos.end===n.end)return;c++,d[c]={html:e,pos:n},d.splice(c+1);c>300&&(c=300,d.splice(0,1))}function x(t,e){const n=[];t.firstChild&&n.push(t.firstChild);let s=n.pop();for(;s&&"stop"!==e(s);)s.nextSibling&&n.push(s.nextSibling),s.firstChild&&n.push(s.firstChild),s=n.pop()}function T(t){return t.metaKey||t.ctrlKey}function N(t){return T(t)&&!t.shiftKey&&"z"===t.key}function L(t){return T(t)&&t.shiftKey&&"z"===t.key}function $(t){t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),i.execCommand("insertHTML",!1,t)}function S(t,e){let n=0;return(...s)=>{clearTimeout(n),n=o.setTimeout((()=>t(...s)),e)}}function R(t){let e=t.length-1;for(;e>=0&&"\n"!==t[e];)e--;e++;let n=e;for(;n<t.length&&/[ \t]/.test(t[n]);)n++;return[t.substring(e,n)||"",e,n]}function A(){return t.textContent||""}function j(t){t.preventDefault()}function D(){var e;return(null===(e=t.parentNode)||void 0===e?void 0:e.nodeType)==Node.DOCUMENT_FRAGMENT_NODE?t.parentNode.getSelection():o.getSelection()}return b("keydown",(e=>{e.defaultPrevented||(r=A(),s.preserveIdent?function(t){if("Enter"===t.key){const e=k(),n=w();let[o]=R(e),i=o;if(s.indentOn.test(e)&&(i+=s.tab),i.length>0?(j(t),t.stopPropagation(),$("\n"+i)):E(t),i!==o&&"}"===n[0]){const t=C();$("\n"+o),v(t)}}}(e):E(e),s.catchTab&&function(t){if("Tab"===t.key)if(j(t),t.shiftKey){const t=k();let[e,n]=R(t);if(e.length>0){const t=C(),o=Math.min(s.tab.length,e.length);v({start:n,end:n+o}),i.execCommand("delete"),t.start-=o,t.end-=o,v(t)}}else $(s.tab)}(e),s.addClosing&&function(t){const e="([{'\"",n=")]}'\"",s=w(),o=k(),i="\\"===o.substr(o.length-1),l=s.substr(0,1);if(n.includes(t.key)&&!i&&l===t.key){const e=C();j(t),e.start=++e.end,v(e)}else if(e.includes(t.key)&&!i&&("\"'".includes(t.key)||[""," ","\n"].includes(l))){j(t);const s=C(),o=s.start==s.end?"":D().toString();$(t.key+o+n[e.indexOf(t.key)]),s.start++,s.end++,v(s)}}(e),s.history&&(!function(e){if(N(e)){j(e),c--;const n=d[c];n&&(t.innerHTML=n.html,v(n.pos)),c<0&&(c=0)}if(L(e)){j(e),c++;const n=d[c];n&&(t.innerHTML=n.html,v(n.pos)),c>=d.length&&c--}}(e),g(e)&&!h&&(O(),h=!0)))})),b("keyup",(t=>{t.defaultPrevented||t.isComposing||(r!==A()&&p(),y(t),l&&l(A()))})),b("focus",(t=>{u=!0})),b("blur",(t=>{u=!1})),b("paste",(n=>{O(),function(n){j(n);const s=(n.originalEvent||n).clipboardData.getData("text/plain").replace(/\r/g,""),o=C();$(s),e(t),v({start:o.start+s.length,end:o.start+s.length})}(n),O(),l&&l(A())})),{updateOptions(t){t=Object.assign(Object.assign({},t),t)},updateCode(n){t.textContent=n,e(t)},onUpdate(t){l=t},toString:A,save:C,restore:v,recordHistory:O,destroy(){for(let[e,n]of a)t.removeEventListener(e,n)}}}function C(t,e={}){const n=Object.assign({class:"codejar-linenumbers",wrapClass:"codejar-wrap",width:"35px",backgroundColor:"rgba(128, 128, 128, 0.15)",color:""},e);let s;return function(e){t(e),s||(s=function(t,e){const n=getComputedStyle(t),s=document.createElement("div");s.className=e.wrapClass,s.style.position="relative";const o=document.createElement("div");o.className=e.class,s.appendChild(o),o.style.position="absolute",o.style.top="0px",o.style.left="0px",o.style.bottom="0px",o.style.width=e.width,o.style.overflow="hidden",o.style.backgroundColor=e.backgroundColor,o.style.color=e.color||n.color,o.style.setProperty("mix-blend-mode","difference"),o.style.fontFamily=n.fontFamily,o.style.fontSize=n.fontSize,o.style.lineHeight=n.lineHeight,o.style.paddingTop=n.paddingTop,o.style.paddingLeft=n.paddingLeft,o.style.borderTopLeftRadius=n.borderTopLeftRadius,o.style.borderBottomLeftRadius=n.borderBottomLeftRadius;const i=document.createElement("div");return i.style.position="relative",i.style.top="0px",o.appendChild(i),t.style.paddingLeft=`calc(${e.width} + ${o.style.paddingLeft})`,t.style.whiteSpace="pre",t.parentNode.insertBefore(s,t),s.appendChild(t),i}(e,n),e.addEventListener("scroll",(()=>s.style.top=`-${e.scrollTop}px`)));const o=(e.textContent||"").replace(/\n+$/,"\n").split("\n").length+1;let i="";for(let t=1;t<o;t++)i+=`${t}\n`;s.innerText=i}}function v(t){let e;return{c(){e=f(t[0])},l(n){e=p(n,t[0])},m(t,n){a(t,e,n)},p(t,n){1&n&&h(e,t[0])},d(t){t&&l(e)}}}function k(t){let e,n,s=t[3](t[0],t[4])+"";return{c(){n=g(),this.h()},l(t){n=g(),this.h()},h(){e=new y(n)},m(t,o){e.m(s,t,o),a(t,n,o)},p(t,n){25&n&&s!==(s=t[3](t[0],t[4])+"")&&e.p(s)},d(t){t&&l(n),t&&e.d()}}}function w(t){let e,n,u,f;function p(t,e){return!t[6]&&t[3]?k:v}let h=p(t),g=h(t);return{c(){e=s("pre"),n=s("code"),g.c(),this.h()},l(t){e=o(t,"PRE",{class:!0,style:!0});var s=i(e);n=o(s,"CODE",{class:!0,"data-language":!0});var r=i(n);g.l(r),r.forEach(l),s.forEach(l),this.h()},h(){r(n,"class",u=t[4]?`language-${t[4]}`:""),r(n,"data-language",t[4]),r(e,"class",f=(t[4]?`language-${t[4]}`:"")+" "+t[1]),r(e,"style",t[2])},m(s,o){a(s,e,o),d(e,n),g.m(n,null),t[13](e)},p(t,[s]){h===(h=p(t))&&g?g.p(t,s):(g.d(1),g=h(t),g&&(g.c(),g.m(n,null))),16&s&&u!==(u=t[4]?`language-${t[4]}`:"")&&r(n,"class",u),16&s&&r(n,"data-language",t[4]),18&s&&f!==(f=(t[4]?`language-${t[4]}`:"")+" "+t[1])&&r(e,"class",f),4&s&&r(e,"style",t[2])},i:c,o:c,d(n){n&&l(e),g.d(),t[13](null)}}}function E(t,e,n){let{class:s=""}=e,{style:o}=e,{addClosing:i=!0}=e,{indentOn:l=/{$/}=e,{spellcheck:r=!1}=e,{tab:a="\t"}=e,{withLineNumbers:d=!1}=e,{highlightCode:c=null}=e,{highlightElement:f=((t,e)=>{})}=e,{syntax:p}=e,{value:h=""}=e,g=null,y=null;function m(t,e,s,o){y&&function(){y.destroy();const t=g.parentElement;if(t.classList.contains("codejar-wrap")){const e=t.parentElement;n(5,g.style.padding="",g),e.appendChild(g),t.remove()}}();const d=s?C((t=>e(t,o))):t=>e(t,o);n(6,y=b(t,d,{addClosing:i,indentOn:l,spellcheck:r,tab:a})),y.onUpdate((t=>{t!==h&&n(0,h=t)}))}return t.$$set=t=>{"class"in t&&n(1,s=t.class),"style"in t&&n(2,o=t.style),"addClosing"in t&&n(7,i=t.addClosing),"indentOn"in t&&n(8,l=t.indentOn),"spellcheck"in t&&n(9,r=t.spellcheck),"tab"in t&&n(10,a=t.tab),"withLineNumbers"in t&&n(11,d=t.withLineNumbers),"highlightCode"in t&&n(3,c=t.highlightCode),"highlightElement"in t&&n(12,f=t.highlightElement),"syntax"in t&&n(4,p=t.syntax),"value"in t&&n(0,h=t.value)},t.$$.update=()=>{6192&t.$$.dirty&&g&&m(g,f,d,p),1984&t.$$.dirty&&y&&y.updateOptions({addClosing:i,indentOn:l,spellcheck:r,tab:a}),65&t.$$.dirty&&y&&y.toString()!==h&&y.updateCode(h)},[h,s,o,c,p,g,y,i,l,r,a,d,f,function(t){u[t?"unshift":"push"]((()=>{g=t,n(5,g)}))}]}class O extends t{constructor(t){super(),e(this,t,E,w,n,{class:1,style:2,addClosing:7,indentOn:8,spellcheck:9,tab:10,withLineNumbers:11,highlightCode:3,highlightElement:12,syntax:4,value:0})}}export{O as CodeJar};
